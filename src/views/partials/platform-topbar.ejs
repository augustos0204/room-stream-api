<!-- Platform Topbar -->
<header
    class="fixed top-0 left-0 right-0 dark-glass border-b border-gray-700/50 z-50"
>
    <div class="flex items-center justify-between px-6 py-4">
        <!-- Left: Logo + Sidebar Toggle + Page Title -->
        <div class="flex items-center gap-4">
            <!-- Logo & Sidebar Toggle -->
            <div class="flex items-center gap-3">
                <button
                    @click="toggleSidebar()"
                    class="p-2 rounded-lg transition-all duration-200 relative"
                    :class="sidebarPinned ? 'bg-purple-600/20 text-purple-400 hover:bg-purple-600/30' : 'hover:bg-gray-700/50 text-gray-400'"
                    :title="sidebarPinned ? 'Desafixar Sidebar' : 'Fixar Sidebar'"
                >
                    <i :data-lucide="sidebarPinned ? 'pin' : 'pin-off'" class="w-5 h-5"></i>
                    <!-- Indicador visual de estado fixado -->
                    <div 
                        x-show="sidebarPinned" 
                        class="absolute -top-1 -right-1 w-2 h-2 bg-purple-500 rounded-full animate-pulse"
                    ></div>
                </button>
                
                <div class="flex items-center gap-3 animate-float">
                    <%- include('../partials/logo', { size: 'xs' }) %>
                    <div class="hidden sm:block">
                        <h1 class="text-lg font-bold bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent leading-tight">
                            RoomStream
                        </h1>
                        <p class="text-xs text-gray-400 -mt-0.5">Platform</p>
                    </div>
                </div>
            </div>

            <!-- Divider -->
            <div class="hidden lg:block w-px h-8 bg-gray-700/50"></div>

            <!-- Page Title -->
            <div class="hidden lg:block">
                <h2 class="text-lg font-bold text-white capitalize" x-text="currentPage === 'dashboard' ? 'Dashboard' : currentPage === 'rooms' ? 'Salas' : 'Configurações'"></h2>
            </div>
        </div>

        <!-- Right: Actions -->
        <div class="flex items-center gap-3">
            <!-- Create Room Button (only on rooms page) -->
            <button
                x-show="currentPage === 'rooms'"
                @click="showCreateRoomModal = true"
                class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 rounded-lg font-medium text-sm text-white transition-all duration-200 flex items-center gap-2"
                title="Criar nova sala"
            >
                <i data-lucide="plus-circle" class="w-4 h-4"></i>
                <span class="hidden md:inline">Nova Sala</span>
            </button>
            <!-- Connection Status -->
            <div
                class="flex items-center gap-2 px-3 py-2 rounded-lg border transition-all"
                :class="isConnected
                    ? 'bg-green-900/20 border-green-700/50'
                    : connecting
                    ? 'bg-yellow-900/20 border-yellow-700/50'
                    : 'bg-gray-800/50 border-gray-700/50'"
            >
                <div class="relative">
                    <div
                        class="w-2 h-2 rounded-full"
                        :class="isConnected ? 'bg-green-500' : connecting ? 'bg-yellow-500' : 'bg-gray-500'"
                    ></div>
                    <div
                        x-show="isConnected"
                        class="absolute inset-0 w-2 h-2 rounded-full bg-green-500 animate-ping"
                    ></div>
                </div>
                <span
                    class="text-xs font-medium hidden sm:inline"
                    :class="isConnected ? 'text-green-400' : connecting ? 'text-yellow-400' : 'text-gray-400'"
                    x-text="isConnected ? 'Online' : connecting ? 'Conectando...' : 'Offline'"
                ></span>
            </div>

            <!-- Keyboard Shortcuts Button -->
            <button
                @click="showShortcutsModal = true"
                class="p-2 hover:bg-gray-700/50 rounded-lg transition-colors"
                title="Atalhos de teclado"
            >
                <i data-lucide="keyboard" class="w-5 h-5 text-gray-400"></i>
            </button>

            <!-- Refresh Rooms -->
            <button
                @click="listRooms()"
                class="p-2 hover:bg-gray-700/50 rounded-lg transition-colors"
                :disabled="isLoadingRooms"
                title="Atualizar salas"
            >
                <i data-lucide="refresh-cw" class="w-5 h-5 text-gray-400" :class="isLoadingRooms && 'animate-spin'"></i>
            </button>

            <!-- Connect/Disconnect Toggle -->
            <button
                @click="toggleConnection()"
                class="px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2"
                :class="isConnected
                    ? 'bg-green-600/20 hover:bg-green-600/30 text-green-400 border border-green-600/50'
                    : connecting
                    ? 'bg-yellow-600/20 text-yellow-400 border border-yellow-600/50 cursor-wait'
                    : 'bg-gray-700/50 hover:bg-gray-700 text-gray-300 border border-gray-600/50'"
                :disabled="connecting"
            >
                <i data-lucide="wifi" class="w-4 h-4" x-show="!connecting"></i>
                <i data-lucide="loader-2" class="w-4 h-4 animate-spin" x-show="connecting"></i>
                <span class="hidden md:inline" x-text="isConnected ? 'Conectado' : connecting ? 'Conectando...' : 'Conectar'"></span>
            </button>
        </div>
    </div>
</header>
